# KQL (Microsoft Defender for Endpoint Advanced Hunting)

This directory contains Microsoft Defender for Endpoint (MDE) Advanced Hunting queries used to detect and investigate
activity generated by the lab scripts in `scripts/`.

## Lab mapping
- `00_setup_lab.sh` → file/directory creation + permission changes
- `01_attack_simulation.sh` → privilege escalation attempt + data staging + optional cloud upload + optional self-delete

## How to use
1. Microsoft 365 Defender Portal → Advanced Hunting
2. Paste a query from this folder
3. Adjust the variables at the top (`DeviceName`, time range, attacker user)
4. Run and export results (CSV) if needed
5. Use `06_master_timeline_reconstruction.kql` to build an investigation timeline

> All queries are written for defensive/educational purposes in an isolated lab environment.

